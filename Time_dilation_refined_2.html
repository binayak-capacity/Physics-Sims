<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Time Dilation Simulation</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body { 
            background: #0a0a0f; 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            overflow: hidden;
            color: #e2e8f0;
        }
        
        .control-bar {
            position: fixed;
            top: 0;
            left: 0;
            right: 320px;
            height: 70px;
            background: rgba(10, 10, 15, 0.9);
            backdrop-filter: blur(12px);
            border-bottom: 1px solid rgba(148, 163, 184, 0.1);
            display: flex;
            align-items: center;
            padding: 0 25px;
            gap: 40px;
            z-index: 1000;
        }
        
        .title {
            font-size: 18px;
            font-weight: 600;
            color: #f1f5f9;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .title-icon {
            width: 24px;
            height: 24px;
            background: linear-gradient(135deg, #3b82f6, #8b5cf6);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
        }
        
        #canvas-container {
            position: fixed;
            top: 70px;
            left: 0;
            right: 320px;
            bottom: 0;
        }
        
        canvas {
            display: block;
            width: 100%;
            height: 100%;
        }
        
        /* Right Side Panel */
        .right-panel {
            position: fixed;
            top: 0;
            right: 0;
            width: 320px;
            height: 100vh;
            background: rgba(10, 10, 15, 0.95);
            backdrop-filter: blur(12px);
            border-left: 1px solid rgba(148, 163, 184, 0.1);
            padding: 20px;
            overflow-y: auto;
            z-index: 1000;
        }
        
        .panel-section {
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 1px solid rgba(148, 163, 184, 0.1);
        }
        
        .panel-section:last-child {
            border-bottom: none;
        }
        
        .panel-title {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 15px;
            color: #f1f5f9;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .control {
            display: flex;
            flex-direction: column;
            gap: 6px;
            font-size: 12px;
            margin-bottom: 15px;
        }
        
        .control-label {
            color: #64748b;
            font-size: 11px;
            text-transform: uppercase;
        }
        
        .control-row {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .slider {
            flex: 1;
            height: 4px;
            -webkit-appearance: none;
            appearance: none;
            background: rgba(148, 163, 184, 0.2);
            border-radius: 2px;
            outline: none;
        }
        
        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 14px;
            height: 14px;
            background: linear-gradient(135deg, #3b82f6, #8b5cf6);
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 2px 8px rgba(59, 130, 246, 0.4);
        }
        
        .slider-value {
            min-width: 50px;
            text-align: right;
            font-weight: 600;
            color: #f1f5f9;
        }
        
        .button-row {
            display: flex;
            gap: 10px;
        }
        
        button {
            flex: 1;
            padding: 10px 16px;
            background: linear-gradient(135deg, #3b82f6, #8b5cf6);
            border: none;
            border-radius: 6px;
            color: white;
            cursor: pointer;
            font-weight: 500;
            font-size: 13px;
            transition: all 0.2s;
        }
        
        button:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.4);
        }
        
        button.secondary {
            background: rgba(148, 163, 184, 0.2);
        }
        
        .formula {
            background: rgba(59, 130, 246, 0.1);
            border: 1px solid rgba(59, 130, 246, 0.2);
            border-radius: 8px;
            padding: 12px;
            margin-bottom: 15px;
            font-family: 'Courier New', monospace;
            text-align: center;
            color: #60a5fa;
        }
        
        .clock-display {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .clock {
            text-align: center;
            background: rgba(15, 23, 42, 0.5);
            border-radius: 8px;
            padding: 12px;
        }
        
        .clock-label {
            font-size: 10px;
            text-transform: uppercase;
            color: #64748b;
            margin-bottom: 5px;
        }
        
        .clock-time {
            font-size: 28px;
            font-weight: 700;
            font-variant-numeric: tabular-nums;
        }
        
        .clock-time.earth {
            color: #34d399;
        }
        
        .clock-time.ship {
            color: #f472b6;
        }
        
        .time-diff {
            text-align: center;
            padding: 12px;
            background: rgba(251, 191, 36, 0.1);
            border-radius: 8px;
            border: 1px solid rgba(251, 191, 36, 0.2);
        }
        
        .time-diff-label {
            font-size: 10px;
            color: #64748b;
            text-transform: uppercase;
        }
        
        .time-diff-value {
            font-size: 20px;
            font-weight: 600;
            color: #fbbf24;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }
        
        .stat-box {
            background: rgba(15, 23, 42, 0.5);
            border-radius: 8px;
            padding: 12px;
            text-align: center;
        }
        
        .stat-box .stat-label {
            font-size: 9px;
            margin-bottom: 4px;
            color: #64748b;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .stat-box .stat-value {
            font-size: 16px;
            font-weight: 600;
            font-variant-numeric: tabular-nums;
        }
        
        .stat-box .stat-value.highlight {
            color: #60a5fa;
        }
        
        .stat-box .stat-value.warning {
            color: #fbbf24;
        }
        
        .about-text {
            color: #94a3b8;
            font-size: 12px;
            line-height: 1.6;
            text-align: justify;
        }
        
        .about-text p {
            margin-bottom: 10px;
        }
        
        .about-text p:last-child {
            margin-bottom: 0;
        }
    </style>
</head>
<body>
    <div class="control-bar">
        <div class="title">
            <div class="title-icon">‚è±</div>
            Time Dilation Simulator
        </div>
    </div>
    
    <div id="canvas-container">
        <canvas id="mainCanvas"></canvas>
    </div>
    
    <!-- Right Side Panel -->
    <div class="right-panel">
        <!-- Controls Section -->
        <div class="panel-section">
            <div class="panel-title">üéõÔ∏è Controls</div>
            <div class="control">
                <span class="control-label">Ship Velocity (% of c)</span>
                <div class="control-row">
                    <input type="range" class="slider" id="velocitySlider" min="0" max="99.9" value="50" step="0.1">
                    <span class="slider-value" id="velocityValue">50%</span>
                </div>
            </div>
            <div class="control">
                <span class="control-label">Simulation Speed</span>
                <div class="control-row">
                    <input type="range" class="slider" id="simSpeed" min="0.1" max="5" value="1" step="0.1">
                    <span class="slider-value" id="simSpeedValue">1x</span>
                </div>
            </div>
            <div class="button-row">
                <button id="reset">Reset Clocks</button>
                <button id="pause" class="secondary">Pause</button>
            </div>
        </div>
        
        <!-- Stats Section -->
        <div class="panel-section">
            <div class="panel-title">üìä Current Stats</div>
            <div class="stats-grid">
                <div class="stat-box">
                    <div class="stat-label">Velocity</div>
                    <div class="stat-value highlight" id="velocity">0.00c</div>
                </div>
                <div class="stat-box">
                    <div class="stat-label">Lorentz (Œ≥)</div>
                    <div class="stat-value warning" id="gamma">1.000</div>
                </div>
            </div>
        </div>
        
        <!-- Elapsed Time Section -->
        <div class="panel-section">
            <div class="panel-title">‚è∞ Elapsed Time</div>
            <div class="clock-display">
                <div class="clock">
                    <div class="clock-label">Earth Time</div>
                    <div class="clock-time earth" id="earthTime">00:00.0</div>
                </div>
                <div class="clock">
                    <div class="clock-label">Ship Time</div>
                    <div class="clock-time ship" id="shipTime">00:00.0</div>
                </div>
                <div class="time-diff">
                    <div class="time-diff-label">Time Saved on Ship</div>
                    <div class="time-diff-value" id="timeDiff">0.0s</div>
                </div>
            </div>
        </div>
        
        <!-- About This Simulation Section -->
        <div class="panel-section">
            <div class="panel-title">‚ÑπÔ∏è About This Simulation</div>
            <div class="about-text">
                <p><strong>Time dilation</strong> is a phenomenon predicted by Einstein's Special Theory of Relativity. It states that time passes more slowly for objects moving at high speeds relative to a stationary observer.</p>
                <p>As an object approaches the speed of light (c), time aboard that object slows down dramatically compared to time for a stationary observer. This effect is quantified by the <strong>Lorentz factor (Œ≥)</strong>.</p>
                <p>In this simulation, watch how the spaceship's clock ticks slower than Earth's clock as velocity increases. At 99% the speed of light, time on the ship passes about 7 times slower than on Earth!</p>
            </div>
        </div>
    </div>
    
    <script>
        const canvas = document.getElementById('mainCanvas');
        const ctx = canvas.getContext('2d');
        
        let width, height;
        let velocityPercent = 50;
        let simSpeed = 1;
        let paused = false;
        let earthTime = 0;
        let shipTime = 0;
        let lastTimestamp = 0;
        
        // Animation state
        let shipX = 0;
        let lightPulses = [];
        let earthStars = [];  // Stationary stars for Earth side
        let shipStars = [];   // Moving stars for Ship side
        let particles = [];
        
        // Ship animation state
        let engineFlicker = 0;
        
        function resize() {
            const container = document.getElementById('canvas-container');
            width = canvas.width = container.clientWidth;
            height = canvas.height = container.clientHeight;
            generateStars();
        }
        
        function generateStars() {
            earthStars = [];
            shipStars = [];
            
            // Generate stationary stars for Earth side (left half)
            for (let i = 0; i < 100; i++) {
                earthStars.push({
                    x: Math.random() * (width / 2),
                    y: Math.random() * height,
                    size: Math.random() * 2 + 0.5,
                    brightness: Math.random() * 0.5 + 0.5,
                    twinkleSpeed: Math.random() * 2 + 1
                });
            }
            
            // Generate moving stars for Ship side (right half)
            for (let i = 0; i < 100; i++) {
                shipStars.push({
                    x: width / 2 + Math.random() * (width / 2),
                    y: Math.random() * height,
                    size: Math.random() * 2 + 0.5,
                    brightness: Math.random() * 0.5 + 0.5,
                    twinkleSpeed: Math.random() * 2 + 1
                });
            }
        }
        
        function calculateLorentzFactor(v) {
            // v is fraction of c (0 to 0.999)
            const vSquared = v * v;
            return 1 / Math.sqrt(1 - vSquared);
        }
        
        function formatTime(seconds) {
            const mins = Math.floor(seconds / 60);
            const secs = seconds % 60;
            return `${mins.toString().padStart(2, '0')}:${secs.toFixed(1).padStart(4, '0')}`;
        }
        
        function drawEarthStars(time) {
            // Draw stationary stars on Earth side (left half)
            ctx.save();
            ctx.beginPath();
            ctx.rect(0, 0, width / 2, height);
            ctx.clip();
            
            earthStars.forEach(star => {
                const twinkle = Math.sin(time * star.twinkleSpeed) * 0.3 + 0.7;
                const alpha = star.brightness * twinkle;
                
                ctx.beginPath();
                ctx.fillStyle = `rgba(255, 255, 255, ${alpha})`;
                ctx.arc(star.x, star.y, star.size, 0, Math.PI * 2);
                ctx.fill();
            });
            
            ctx.restore();
        }
        
        function drawShipStars(time) {
            const v = velocityPercent / 100;
            
            // Draw moving stars on Ship side (right half)
            ctx.save();
            ctx.beginPath();
            ctx.rect(width / 2, 0, width / 2, height);
            ctx.clip();
            
            shipStars.forEach(star => {
                // Stars streak based on velocity
                const streakLength = v * 50;
                const twinkle = Math.sin(time * star.twinkleSpeed) * 0.3 + 0.7;
                const alpha = star.brightness * twinkle;
                
                ctx.beginPath();
                if (streakLength > 1) {
                    ctx.strokeStyle = `rgba(255, 255, 255, ${alpha * 0.5})`;
                    ctx.lineWidth = star.size * 0.5;
                    ctx.moveTo(star.x, star.y);
                    ctx.lineTo(star.x + streakLength, star.y);
                    ctx.stroke();
                }
                
                ctx.fillStyle = `rgba(255, 255, 255, ${alpha})`;
                ctx.arc(star.x, star.y, star.size, 0, Math.PI * 2);
                ctx.fill();
                
                // Move stars based on ship velocity (only on ship side)
                star.x -= v * 3 * simSpeed;
                if (star.x < width / 2) {
                    star.x = width + 10;
                    star.y = Math.random() * height;
                }
            });
            
            ctx.restore();
        }
        
        function drawDividerLine() {
            const centerX = width / 2;
            
            // Draw glowing divider line
            ctx.save();
            
            // Outer glow
            const gradient = ctx.createLinearGradient(centerX - 20, 0, centerX + 20, 0);
            gradient.addColorStop(0, 'rgba(100, 150, 255, 0)');
            gradient.addColorStop(0.5, 'rgba(100, 150, 255, 0.3)');
            gradient.addColorStop(1, 'rgba(100, 150, 255, 0)');
            ctx.fillStyle = gradient;
            ctx.fillRect(centerX - 20, 0, 40, height);
            
            // Main line
            ctx.strokeStyle = 'rgba(150, 180, 255, 0.6)';
            ctx.lineWidth = 2;
            ctx.setLineDash([10, 10]);
            ctx.beginPath();
            ctx.moveTo(centerX, 0);
            ctx.lineTo(centerX, height);
            ctx.stroke();
            ctx.setLineDash([]);
            
            // Labels
            ctx.fillStyle = 'rgba(52, 211, 153, 0.8)';
            ctx.font = 'bold 14px -apple-system, sans-serif';
            ctx.textAlign = 'center';
            ctx.fillText('EARTH FRAME', centerX / 2, 30);
            
            ctx.fillStyle = 'rgba(244, 114, 182, 0.8)';
            ctx.fillText('SHIP FRAME', centerX + centerX / 2, 30);
            
            ctx.restore();
        }
        
        function drawEarth(time) {
            // Centered position - Earth on the left side of center
            const centerX = width / 4;
            const centerY = height / 2 - 100;  // Moved up for more spacing
            const earthX = centerX;
            const earthY = centerY;
            const earthRadius = 45;
            
            // Earth atmosphere glow
            const glowGradient = ctx.createRadialGradient(earthX, earthY, earthRadius * 0.9, earthX, earthY, earthRadius * 1.8);
            glowGradient.addColorStop(0, 'rgba(100, 180, 255, 0.3)');
            glowGradient.addColorStop(0.5, 'rgba(100, 180, 255, 0.1)');
            glowGradient.addColorStop(1, 'rgba(100, 180, 255, 0)');
            ctx.fillStyle = glowGradient;
            ctx.beginPath();
            ctx.arc(earthX, earthY, earthRadius * 1.8, 0, Math.PI * 2);
            ctx.fill();
            
            // Ocean base (deep blue)
            const oceanGradient = ctx.createRadialGradient(earthX - 15, earthY - 15, 0, earthX, earthY, earthRadius);
            oceanGradient.addColorStop(0, '#4a90d9');
            oceanGradient.addColorStop(0.5, '#2563eb');
            oceanGradient.addColorStop(1, '#1e40af');
            ctx.fillStyle = oceanGradient;
            ctx.beginPath();
            ctx.arc(earthX, earthY, earthRadius, 0, Math.PI * 2);
            ctx.fill();
            
            // Save context for clipping
            ctx.save();
            ctx.beginPath();
            ctx.arc(earthX, earthY, earthRadius, 0, Math.PI * 2);
            ctx.clip();
            
            // North America (green/brown landmass)
            ctx.fillStyle = '#228B22';
            ctx.beginPath();
            ctx.ellipse(earthX - 20, earthY - 15, 18, 22, 0.2, 0, Math.PI * 2);
            ctx.fill();
            
            // South America
            ctx.fillStyle = '#2d8a2d';
            ctx.beginPath();
            ctx.ellipse(earthX - 8, earthY + 18, 10, 18, 0.3, 0, Math.PI * 2);
            ctx.fill();
            
            // Europe/Africa
            ctx.fillStyle = '#8B7355';
            ctx.beginPath();
            ctx.ellipse(earthX + 18, earthY - 5, 12, 25, 0.1, 0, Math.PI * 2);
            ctx.fill();
            
            // Greenland
            ctx.fillStyle = '#f0f0f0';
            ctx.beginPath();
            ctx.ellipse(earthX - 5, earthY - 32, 8, 6, 0.2, 0, Math.PI * 2);
            ctx.fill();
            
            // Antarctica
            ctx.fillStyle = '#ffffff';
            ctx.beginPath();
            ctx.ellipse(earthX, earthY + 40, 25, 8, 0, 0, Math.PI * 2);
            ctx.fill();
            
            // Arctic ice cap
            ctx.fillStyle = '#f8f8ff';
            ctx.beginPath();
            ctx.ellipse(earthX, earthY - 40, 20, 7, 0, 0, Math.PI * 2);
            ctx.fill();
            
            // Cloud layers
            ctx.fillStyle = 'rgba(255, 255, 255, 0.4)';
            ctx.beginPath();
            ctx.ellipse(earthX - 15, earthY - 25, 12, 4, 0.3, 0, Math.PI * 2);
            ctx.fill();
            ctx.beginPath();
            ctx.ellipse(earthX + 20, earthY + 10, 15, 5, -0.2, 0, Math.PI * 2);
            ctx.fill();
            ctx.beginPath();
            ctx.ellipse(earthX - 5, earthY + 25, 10, 3, 0.1, 0, Math.PI * 2);
            ctx.fill();
            
            ctx.restore();
            
            // Atmosphere rim highlight
            ctx.strokeStyle = 'rgba(135, 206, 250, 0.5)';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.arc(earthX, earthY + 1, earthRadius + 1, 0, Math.PI * 2);
            ctx.stroke();
            
            // Specular highlight
            const highlightGradient = ctx.createRadialGradient(earthX - 20, earthY - 20, 0, earthX - 20, earthY - 20, 25);
            highlightGradient.addColorStop(0, 'rgba(255, 255, 255, 0.3)');
            highlightGradient.addColorStop(1, 'rgba(255, 255, 255, 0)');
            ctx.fillStyle = highlightGradient;
            ctx.beginPath();
            ctx.arc(earthX - 15, earthY - 15, 20, 0, Math.PI * 2);
            ctx.fill();
            
            // Earth clock - moved down with more spacing
            drawClock(earthX, earthY + 100, earthTime, '#34d399', 'EARTH');
        }
        
        function drawSpaceship(time) {
            // Fixed centered position - Ship on the right side (no oscillation)
            const centerX = width * 3 / 4;
            const centerY = height / 2 - 100;  // Moved up for more spacing
            const shipY = centerY;
            const baseX = centerX;  // Removed the oscillation (Math.sin)
            
            const v = velocityPercent / 100;
            
            // Update engine flicker
            engineFlicker = Math.sin(time * 20) * 0.3 + Math.sin(time * 33) * 0.2 + 0.5;
            
            // Engine exhaust trail
            const trailLength = 80 + v * 200;
            for (let i = 0; i < 30; i++) {
                const t = i / 30;
                const x = baseX - 55 - t * trailLength;
                const spread = t * 25;
                const alpha = (1 - t) * 0.7 * (0.5 + v * 0.5) * engineFlicker;
                
                // Core exhaust (bright cyan/white)
                const coreGradient = ctx.createRadialGradient(x, shipY, 0, x, shipY, 8 * (1 - t * 0.5));
                coreGradient.addColorStop(0, `rgba(200, 255, 255, ${alpha})`);
                coreGradient.addColorStop(0.5, `rgba(100, 200, 255, ${alpha * 0.7})`);
                coreGradient.addColorStop(1, `rgba(50, 100, 255, 0)`);
                ctx.fillStyle = coreGradient;
                ctx.beginPath();
                ctx.arc(x + (Math.random() - 0.5) * spread * 0.3, shipY + (Math.random() - 0.5) * spread, 8 * (1 - t * 0.5), 0, Math.PI * 2);
                ctx.fill();
                
                // Outer exhaust particles
                if (Math.random() > 0.5) {
                    ctx.fillStyle = `rgba(100, 180, 255, ${alpha * 0.5})`;
                    ctx.beginPath();
                    ctx.arc(x + (Math.random() - 0.5) * spread, shipY + (Math.random() - 0.5) * spread, 3, 0, Math.PI * 2);
                    ctx.fill();
                }
            }
            
            // Ship glow
            const glowGradient = ctx.createRadialGradient(baseX, shipY, 30, baseX, shipY, 100);
            glowGradient.addColorStop(0, 'rgba(100, 150, 255, 0.2)');
            glowGradient.addColorStop(1, 'rgba(100, 150, 255, 0)');
            ctx.fillStyle = glowGradient;
            ctx.beginPath();
            ctx.arc(baseX, shipY, 100, 0, Math.PI * 2);
            ctx.fill();
            
            // === IMPROVED SPACESHIP DESIGN ===
            
            // Main hull (sleek elongated shape)
            ctx.save();
            ctx.translate(baseX, shipY);
            
            // Hull shadow/depth
            ctx.fillStyle = '#1a1a2e';
            ctx.beginPath();
            ctx.moveTo(60, 0);
            ctx.bezierCurveTo(50, -8, 20, -18, -20, -22);
            ctx.lineTo(-50, -18);
            ctx.lineTo(-55, 0);
            ctx.lineTo(-50, 18);
            ctx.lineTo(-20, 22);
            ctx.bezierCurveTo(20, 18, 50, 8, 60, 0);
            ctx.closePath();
            ctx.fill();
            
            // Main hull body
            const hullGradient = ctx.createLinearGradient(0, -25, 0, 25);
            hullGradient.addColorStop(0, '#4a5568');
            hullGradient.addColorStop(0.3, '#718096');
            hullGradient.addColorStop(0.5, '#a0aec0');
            hullGradient.addColorStop(0.7, '#718096');
            hullGradient.addColorStop(1, '#4a5568');
            ctx.fillStyle = hullGradient;
            ctx.beginPath();
            ctx.moveTo(55, 0);
            ctx.bezierCurveTo(45, -7, 15, -15, -15, -18);
            ctx.lineTo(-45, -15);
            ctx.lineTo(-50, 0);
            ctx.lineTo(-45, 15);
            ctx.lineTo(-15, 18);
            ctx.bezierCurveTo(15, 15, 45, 7, 55, 0);
            ctx.closePath();
            ctx.fill();
            
            // Hull panel lines
            ctx.strokeStyle = 'rgba(0, 0, 0, 0.3)';
            ctx.lineWidth = 1;
            ctx.beginPath();
            ctx.moveTo(30, -12);
            ctx.lineTo(-30, -16);
            ctx.stroke();
            ctx.beginPath();
            ctx.moveTo(30, 12);
            ctx.lineTo(-30, 16);
            ctx.stroke();
            
            // Cockpit window
            const cockpitGradient = ctx.createRadialGradient(35, -3, 0, 35, 0, 15);
            cockpitGradient.addColorStop(0, '#60a5fa');
            cockpitGradient.addColorStop(0.5, '#3b82f6');
            cockpitGradient.addColorStop(1, '#1e40af');
            ctx.fillStyle = cockpitGradient;
            ctx.beginPath();
            ctx.ellipse(35, 0, 15, 8, 0, 0, Math.PI * 2);
            ctx.fill();
            
            // Cockpit reflection
            ctx.fillStyle = 'rgba(255, 255, 255, 0.4)';
            ctx.beginPath();
            ctx.ellipse(38, -3, 6, 3, -0.3, 0, Math.PI * 2);
            ctx.fill();
            
            // Wing - top
            const wingGradient = ctx.createLinearGradient(0, -20, 0, -35);
            wingGradient.addColorStop(0, '#4a5568');
            wingGradient.addColorStop(1, '#2d3748');
            ctx.fillStyle = wingGradient;
            ctx.beginPath();
            ctx.moveTo(-10, -15);
            ctx.lineTo(-35, -35);
            ctx.lineTo(-50, -30);
            ctx.lineTo(-45, -15);
            ctx.closePath();
            ctx.fill();
            
            // Wing - bottom
            ctx.beginPath();
            ctx.moveTo(-10, 15);
            ctx.lineTo(-35, 35);
            ctx.lineTo(-50, 30);
            ctx.lineTo(-45, 15);
            ctx.closePath();
            ctx.fill();
            
            // Engine nacelles
            ctx.fillStyle = '#2d3748';
            ctx.beginPath();
            ctx.roundRect(-55, -12, 20, 8, 3);
            ctx.fill();
            ctx.beginPath();
            ctx.roundRect(-55, 4, 20, 8, 3);
            ctx.fill();
            
            // Engine glow
            const engineGlowIntensity = 0.5 + v * 0.5;
            const engineGlow = ctx.createRadialGradient(-55, -8, 0, -55, -8, 15);
            engineGlow.addColorStop(0, `rgba(100, 200, 255, ${engineGlowIntensity * engineFlicker})`);
            engineGlow.addColorStop(0.5, `rgba(50, 150, 255, ${engineGlowIntensity * 0.5 * engineFlicker})`);
            engineGlow.addColorStop(1, 'rgba(50, 100, 255, 0)');
            ctx.fillStyle = engineGlow;
            ctx.beginPath();
            ctx.arc(-55, -8, 15, 0, Math.PI * 2);
            ctx.fill();
            
            const engineGlow2 = ctx.createRadialGradient(-55, 8, 0, -55, 8, 15);
            engineGlow2.addColorStop(0, `rgba(100, 200, 255, ${engineGlowIntensity * engineFlicker})`);
            engineGlow2.addColorStop(0.5, `rgba(50, 150, 255, ${engineGlowIntensity * 0.5 * engineFlicker})`);
            engineGlow2.addColorStop(1, 'rgba(50, 100, 255, 0)');
            ctx.fillStyle = engineGlow2;
            ctx.beginPath();
            ctx.arc(-55, 8, 15, 0, Math.PI * 2);
            ctx.fill();
            
            // Antenna
            ctx.strokeStyle = '#a0aec0';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(50, -5);
            ctx.lineTo(65, -12);
            ctx.stroke();
            
            // Antenna tip light (blinking)
            const blinkAlpha = Math.sin(time * 5) > 0 ? 1 : 0.3;
            ctx.fillStyle = `rgba(255, 100, 100, ${blinkAlpha})`;
            ctx.beginPath();
            ctx.arc(65, -12, 3, 0, Math.PI * 2);
            ctx.fill();
            
            ctx.restore();
            
            // Ship clock - moved down with more spacing
            drawClock(baseX, shipY + 100, shipTime, '#f472b6', 'SHIP');
            
            // Velocity indicator
            ctx.fillStyle = 'rgba(244, 114, 182, 0.8)';
            ctx.font = 'bold 14px -apple-system, sans-serif';
            ctx.textAlign = 'center';
            ctx.fillText(`${velocityPercent.toFixed(1)}% c`, baseX, shipY - 60);
        }
        
        function drawClock(x, y, time, color, label) {
            const radius = 35;
            
            // Clock face
            ctx.fillStyle = 'rgba(15, 23, 42, 0.8)';
            ctx.strokeStyle = color;
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.arc(x, y, radius, 0, Math.PI * 2);
            ctx.fill();
            ctx.stroke();
            
            // Clock ticks
            for (let i = 0; i < 12; i++) {
                const angle = (i / 12) * Math.PI * 2 - Math.PI / 2;
                const innerR = radius - 8;
                const outerR = radius - 3;
                ctx.strokeStyle = 'rgba(255, 255, 255, 0.5)';
                ctx.lineWidth = 1;
                ctx.beginPath();
                ctx.moveTo(x + Math.cos(angle) * innerR, y + Math.sin(angle) * innerR);
                ctx.lineTo(x + Math.cos(angle) * outerR, y + Math.sin(angle) * outerR);
                ctx.stroke();
            }
            
            // Second hand
            const secondAngle = (time % 60) / 60 * Math.PI * 2 - Math.PI / 2;
            ctx.strokeStyle = color;
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(x, y);
            ctx.lineTo(x + Math.cos(secondAngle) * (radius - 10), y + Math.sin(secondAngle) * (radius - 10));
            ctx.stroke();
            
            // Center dot
            ctx.fillStyle = color;
            ctx.beginPath();
            ctx.arc(x, y, 4, 0, Math.PI * 2);
            ctx.fill();
            
            // Label
            ctx.fillStyle = 'rgba(255, 255, 255, 0.6)';
            ctx.font = '10px -apple-system, sans-serif';
            ctx.textAlign = 'center';
            ctx.fillText(label, x, y + radius + 20);
        }
        
        function drawLightBeams(time) {
            // Light clocks positioned in each frame - moved down for more spacing from clocks
            const earthClockX = width / 4;
            const shipClockX = width * 3 / 4;
            const centerY = height / 2 + 180;  // Increased spacing from clocks
            
            // Stationary light clock (Earth)
            drawLightClock(earthClockX, centerY, time, 1, '#34d399', 'Stationary');
            
            // Moving light clock (Ship) - fixed position, no oscillation
            const gamma = calculateLorentzFactor(velocityPercent / 100);
            drawLightClock(shipClockX, centerY, time, gamma, '#f472b6', 'Moving');
        }
        
        function drawLightClock(x, y, time, gamma, color, label) {
            const mirrorHeight = 50;
            const mirrorWidth = 35;
            
            // Mirrors
            ctx.strokeStyle = 'rgba(255, 255, 255, 0.5)';
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.moveTo(x - mirrorWidth / 2, y - mirrorHeight);
            ctx.lineTo(x + mirrorWidth / 2, y - mirrorHeight);
            ctx.stroke();
            ctx.beginPath();
            ctx.moveTo(x - mirrorWidth / 2, y + mirrorHeight);
            ctx.lineTo(x + mirrorWidth / 2, y + mirrorHeight);
            ctx.stroke();
            
            // Light photon bouncing
            const period = 2; // seconds for one bounce
            const adjustedTime = time / gamma;
            const phase = (adjustedTime % period) / period;
            const photonY = y + (phase < 0.5 ? 
                -mirrorHeight + phase * 2 * mirrorHeight * 2 :
                mirrorHeight - (phase - 0.5) * 2 * mirrorHeight * 2);
            
            // Photon trail
            ctx.strokeStyle = `rgba(96, 165, 250, 0.3)`;
            ctx.lineWidth = 2;
            ctx.setLineDash([5, 5]);
            ctx.beginPath();
            ctx.moveTo(x, y - mirrorHeight);
            ctx.lineTo(x, photonY);
            ctx.stroke();
            ctx.setLineDash([]);
            
            // Photon
            const photonGlow = ctx.createRadialGradient(x, photonY, 0, x, photonY, 15);
            photonGlow.addColorStop(0, '#60a5fa');
            photonGlow.addColorStop(0.5, 'rgba(96, 165, 250, 0.5)');
            photonGlow.addColorStop(1, 'rgba(96, 165, 250, 0)');
            ctx.fillStyle = photonGlow;
            ctx.beginPath();
            ctx.arc(x, photonY, 15, 0, Math.PI * 2);
            ctx.fill();
            
            ctx.fillStyle = '#60a5fa';
            ctx.beginPath();
            ctx.arc(x, photonY, 6, 0, Math.PI * 2);
            ctx.fill();
            
            // Label - positioned below the bottom mirror with more spacing
            ctx.fillStyle = color;
            ctx.font = 'bold 12px -apple-system, sans-serif';
            ctx.textAlign = 'center';
            ctx.fillText(label, x, y + mirrorHeight + 30);
            
            // Gamma value - positioned below the label with proper spacing
            if (gamma > 1) {
                ctx.fillStyle = 'rgba(255, 255, 255, 0.6)';
                ctx.font = '11px -apple-system, sans-serif';
                ctx.fillText(`Œ≥ = ${gamma.toFixed(3)}`, x, y + mirrorHeight + 48);
            }
        }
        
        function updateStats() {
            const v = velocityPercent / 100;
            const gamma = calculateLorentzFactor(v);
            
            document.getElementById('velocity').textContent = `${v.toFixed(3)}c`;
            document.getElementById('gamma').textContent = gamma.toFixed(3);
            
            document.getElementById('earthTime').textContent = formatTime(earthTime);
            document.getElementById('shipTime').textContent = formatTime(shipTime);
            document.getElementById('timeDiff').textContent = `${(earthTime - shipTime).toFixed(1)}s`;
        }
        
        function animate(timestamp) {
            if (!lastTimestamp) lastTimestamp = timestamp;
            const deltaTime = (timestamp - lastTimestamp) / 1000;
            lastTimestamp = timestamp;
            
            // Clear canvas
            ctx.fillStyle = '#0a0a0f';
            ctx.fillRect(0, 0, width, height);
            
            // Update time if not paused
            if (!paused) {
                const v = velocityPercent / 100;
                const gamma = calculateLorentzFactor(v);
                
                earthTime += deltaTime * simSpeed;
                shipTime += (deltaTime * simSpeed) / gamma;
            }
            
            const time = earthTime;
            
            // Draw scene - stars first (separated by frame)
            drawEarthStars(time);
            drawShipStars(time);
            
            // Draw divider line
            drawDividerLine();
            
            // Draw objects
            drawEarth(time);
            drawSpaceship(time);
            drawLightBeams(time);
            
            updateStats();
            
            requestAnimationFrame(animate);
        }
        
        // Event listeners
        document.getElementById('velocitySlider').addEventListener('input', (e) => {
            velocityPercent = parseFloat(e.target.value);
            document.getElementById('velocityValue').textContent = `${velocityPercent.toFixed(1)}%`;
        });
        
        document.getElementById('simSpeed').addEventListener('input', (e) => {
            simSpeed = parseFloat(e.target.value);
            document.getElementById('simSpeedValue').textContent = `${simSpeed.toFixed(1)}x`;
        });
        
        document.getElementById('reset').addEventListener('click', () => {
            earthTime = 0;
            shipTime = 0;
        });
        
        document.getElementById('pause').addEventListener('click', (e) => {
            paused = !paused;
            e.target.textContent = paused ? 'Resume' : 'Pause';
        });
        
        window.addEventListener('resize', resize);
        
        // Initialize
        resize();
        requestAnimationFrame(animate);
    </script>
</body>
</html>